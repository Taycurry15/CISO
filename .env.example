# Docker Compose Environment Configuration
# Copy this file to .env and fill in your values
# IMPORTANT: Change all passwords and secrets before deploying to production!

# ============================================================================
# Database Configuration
# ============================================================================
POSTGRES_USER=cmmc_admin
POSTGRES_PASSWORD=  # REQUIRED: Set a strong password (min 16 chars, mix of letters/numbers/symbols)
POSTGRES_DB=cmmc_platform
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}

# ============================================================================
# MinIO Object Storage Configuration
# ============================================================================
MINIO_ROOT_USER=  # REQUIRED: Set MinIO admin username
MINIO_ROOT_PASSWORD=  # REQUIRED: Set a strong password (min 16 chars)
MINIO_ENDPOINT=minio:9000

# ============================================================================
# Domain Configuration (for SSL/TLS)
# ============================================================================
DOMAIN=  # REQUIRED: Your domain name (e.g., cmmc.example.com)
LETSENCRYPT_EMAIL=  # REQUIRED: Email for Let's Encrypt notifications

# ============================================================================
# Application Security
# ============================================================================
JWT_SECRET=  # REQUIRED: Generate with: openssl rand -hex 32
JWT_EXPIRATION=86400  # Token expiration in seconds (default: 24 hours)
BCRYPT_ROUNDS=12  # Password hashing rounds (12 is recommended)

# ============================================================================
# AI Provider Configuration
# ============================================================================
# Choose: openai or anthropic
AI_PROVIDER=openai
AI_MODEL=gpt-4-turbo-preview  # or gpt-4, gpt-4o, claude-3-5-sonnet-20240620
AI_API_KEY=  # REQUIRED: Your OpenAI or Anthropic API key

# ============================================================================
# Embedding Service Configuration
# ============================================================================
# Choose: openai or sentence_transformers
EMBEDDING_PROVIDER=openai
EMBEDDING_MODEL=text-embedding-3-small  # or text-embedding-3-large, all-MiniLM-L6-v2
EMBEDDING_API_KEY=  # Optional: Use AI_API_KEY if not specified

# ============================================================================
# Redis Configuration
# ============================================================================
REDIS_URL=redis://redis:6379/0
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/0

# ============================================================================
# Object Storage Paths
# ============================================================================
OBJECT_STORAGE_PATH=/var/cmmc/evidence
EXPORT_PATH=/var/cmmc/exports

# ============================================================================
# Integration Credentials (Optional)
# ============================================================================

# Nessus Configuration
NESSUS_MODE=api  # api or file
NESSUS_ACCESS_KEY=
NESSUS_SECRET_KEY=
NESSUS_URL=https://cloud.tenable.com

# Splunk Configuration
SPLUNK_HOST=
SPLUNK_PORT=8088
SPLUNK_TOKEN=
SPLUNK_INDEX=main

# Azure Configuration
AZURE_TENANT_ID=
AZURE_CLIENT_ID=
AZURE_CLIENT_SECRET=
AZURE_SUBSCRIPTION_ID=

# AWS Configuration
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-gov-west-1

# M365 Configuration
M365_TENANT_ID=
M365_CLIENT_ID=
M365_CLIENT_SECRET=

# ============================================================================
# Feature Flags
# ============================================================================
ENABLE_AI_ANALYSIS=true
ENABLE_RAG=true
ENABLE_PROVIDER_INHERITANCE=true
ENABLE_DIAGRAM_EXTRACTION=false  # Experimental feature

# ============================================================================
# Logging Configuration
# ============================================================================
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
